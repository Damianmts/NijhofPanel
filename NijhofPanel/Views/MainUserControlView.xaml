<UserControl x:Class="NijhofPanel.Views.MainUserControlView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:views="clr-namespace:NijhofPanel.Views"
             xmlns:viewModel="clr-namespace:NijhofPanel.ViewModels"
             xmlns:services="clr-namespace:NijhofPanel.UI.Controls.Navigation"
             xmlns:local="clr-namespace:NijhofPanel.Views.Converters"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance viewModel:MainUserControlViewModel, IsDesignTimeCreatable=True}"
             Background="{DynamicResource CurrentBackgroundColor}"
             Height="700"
             Width="330"
             MinHeight="700"
             MinWidth="330">

    <!-- To Do -->
    <!-- TODO - Fix/ Make Dark Mode -->

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary
                    Source="pack://application:,,,/NijhofPanel;component/Resources/Icons/IconsVectorSidebar.xaml" />
                <ResourceDictionary
                    Source="pack://application:,,,/NijhofPanel;component/Resources/Icons/IconsVectorETools.xaml" />
                <ResourceDictionary
                    Source="pack://application:,,,/NijhofPanel;component/UI/Themes/Base/CoreTheme.xaml" />
                <ResourceDictionary
                    Source="pack://application:,,,/NijhofPanel;component/UI/Themes/Layout/Sidebar.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <SolidColorBrush x:Key="CurrentBackgroundColor"
                             Color="{Binding Color, Source={StaticResource BackgroundColor}}" />

            <local:BooleanToColumnConverter x:Key="BoolToColumnConverter" />
            <local:BooleanToColumnSpanConverter x:Key="BoolToColumnSpanConverter" />
            <local:BooleanHiddenVisibilityConverter x:Key="BoolToVisibilityConverter" />
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="50" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <!-- Sidebar met Visibility binding -->
        <Border Grid.Row="0" Grid.RowSpan="2" Grid.Column="0"
                BorderThickness="0,0,1,0"
                BorderBrush="LightGray"
                Visibility="{Binding SidebarVisibility, RelativeSource={RelativeSource AncestorType=UserControl}}">
            <DockPanel LastChildFill="False">
                <ListBox x:Name="Sidebar"
                         DockPanel.Dock="Top"
                         BorderThickness="0"
                         Background="Transparent"
                         HorizontalContentAlignment="Center">
                    <services:NavButton ViewType="{x:Type views:StartPageView}"
                                        Icon="{StaticResource HomeIcon}"
                                        Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                    <Separator /><Separator />
                    <services:NavButton ViewType="{x:Type views:ToolsPageView}"
                                        Icon="{StaticResource WToolsIcon}"
                                        Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                    <Separator />
                    <services:NavButton ViewType="{x:Type views:ElectricalPageView}"
                                        Icon="{StaticResource EToolsIcon}"
                                        Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                    <Separator /><Separator />
                    <services:WindowButton Navlink="LibraryWindowView" Icon="{StaticResource LibraryIcon}"
                                           Command="{Binding DataContext.OpenWindowCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                    <Separator />
                    <services:WindowButton Navlink="PrefabWindowView" Icon="{StaticResource PrefabIcon}"
                                           Command="{Binding DataContext.OpenWindowCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                    <Separator />
                    <services:WindowButton Navlink="FittingListWindowView" Icon="{StaticResource FittingsIcon}"
                                           Command="{Binding DataContext.OpenWindowCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                    <Separator />
                    <services:WindowButton Navlink="SawListWindowView" Icon="{StaticResource SawIcon}"
                                           Command="{Binding DataContext.OpenWindowCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                </ListBox>

                <ListBox x:Name="SidebarBottom"
                         DockPanel.Dock="Bottom"
                         BorderThickness="0"
                         Background="Transparent"
                         HorizontalContentAlignment="Center">
                    <Separator /><Separator />
                    <services:NavButton
                        Icon="{StaticResource DarkModeIcon}"
                        Command="{Binding Com_ToggleTheme}" />
                    <Separator />
                    <services:NavButton ViewType="{x:Type views:LogInPageView}"
                                        Icon="{StaticResource UserIcon}"
                                        Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                    <Separator />
                    <services:NavButton ViewType="{x:Type views:SettingsPageView}"
                                        Icon="{StaticResource SettingsIcon}"
                                        Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" />
                </ListBox>
            </DockPanel>
        </Border>


        <!-- Frame met ColumnSpan binding -->
        <Frame Grid.Row="0" x:Name="NavigationFrame"
               x:FieldModifier="public"
               Grid.Column="{Binding DataContext.IsLoggedIn,
                             RelativeSource={RelativeSource AncestorType=UserControl},
                             Converter={StaticResource BoolToColumnConverter}}"
               Grid.ColumnSpan="{Binding DataContext.IsLoggedIn,
                                  RelativeSource={RelativeSource AncestorType=UserControl},
                                  Converter={StaticResource BoolToColumnSpanConverter}}"
               NavigationUIVisibility="Hidden"
               Background="#e9ecef" />

        <Border x:Name="WarningBar"
                Grid.Row="0"
                Grid.RowSpan="2"
                Grid.Column="1"
                Background="#CC0000"
                BorderBrush="#CC0000"
                BorderThickness="0,1,0,0"
                Visibility="{Binding IsWarningVisible, Converter={StaticResource BoolToVisibilityConverter}}"
                Padding="8,4"
                VerticalAlignment="Bottom"
                Panel.ZIndex="100">
            <DockPanel LastChildFill="True">
                <Button DockPanel.Dock="Right"
                        Content="X"
                        Click="CloseWarningButton_Click"
                        Background="Transparent"
                        BorderThickness="0"
                        FontWeight="Bold"
                        Foreground="Black"
                        Margin="8,0,0,0"
                        Padding="4,0" />
                <TextBlock Text="{Binding WarningMessage}"
                           Foreground="Black"
                           TextWrapping="Wrap"
                           VerticalAlignment="Center" />
            </DockPanel>
        </Border>
    </Grid>
</UserControl>